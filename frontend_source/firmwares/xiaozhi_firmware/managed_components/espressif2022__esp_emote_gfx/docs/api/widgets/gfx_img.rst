Image Widget (gfx_img)
=======================

The image widget displays static images in RGB565 or RGB565A8 format.

Types
-----

gfx_color_format_t
~~~~~~~~~~~~~~~~~~

Color format enumeration.

.. code-block:: c

   typedef enum {
       GFX_COLOR_FORMAT_RGB565   = 0x04,  ///< RGB565 format without alpha channel
       GFX_COLOR_FORMAT_RGB565A8 = 0x0A,  ///< RGB565 format with separate alpha channel
   } gfx_color_format_t;

gfx_image_header_t
~~~~~~~~~~~~~~~~~~

Image header structure.

.. code-block:: c

   typedef struct {
       uint32_t magic: 8;          ///< Magic number
       uint32_t cf : 8;            ///< Color format
       uint32_t flags: 16;         ///< Image flags
       uint32_t w: 16;             ///< Width of the image
       uint32_t h: 16;             ///< Height of the image
       uint32_t stride: 16;        ///< Number of bytes in a row
       uint32_t reserved: 16;      ///< Reserved for future use
   } gfx_image_header_t;

gfx_image_dsc_t
~~~~~~~~~~~~~~~

Image descriptor structure (compatible with LVGL).

.. code-block:: c

   typedef struct {
       gfx_image_header_t header;   ///< Image header
       uint32_t data_size;         ///< Size of the image in bytes
       const uint8_t *data;        ///< Pointer to the data of the image
       const void *reserved;       ///< Reserved field
       const void *reserved_2;     ///< Reserved field
   } gfx_image_dsc_t;

Macros
------

C_ARRAY_HEADER_MAGIC
~~~~~~~~~~~~~~~~~~~~~

Magic number for C array image headers.

.. code-block:: c

   #define C_ARRAY_HEADER_MAGIC    0x19

Functions
---------

Object Creation
~~~~~~~~~~~~~~~

gfx_img_create()
~~~~~~~~~~~~~~~~

Create an image object.

.. code-block:: c

   gfx_obj_t *gfx_img_create(gfx_handle_t handle);

**Parameters:**

* ``handle`` - Animation player handle

**Returns:**

* Pointer to the created image object, NULL on error

Image Operations
~~~~~~~~~~~~~~~

gfx_img_set_src()
~~~~~~~~~~~~~~~~~~

Set the source data for an image object.

.. code-block:: c

   esp_err_t gfx_img_set_src(gfx_obj_t *obj, void *src);

**Parameters:**

* ``obj`` - Pointer to the image object
* ``src`` - Pointer to the image source data (gfx_image_dsc_t*)

**Returns:**

* ESP_OK on success, error code otherwise

**Example - Using C Array Format:**

.. code-block:: c

   // Image data generated by conversion script (C array format)
   extern const gfx_image_dsc_t my_image;
   
   gfx_obj_t *img = gfx_img_create(handle);
   gfx_img_set_src(img, (void*)&my_image);
   gfx_obj_set_pos(img, 100, 100);

**Example - Using Binary Format:**

.. code-block:: c

   // Binary image data with header
   const uint8_t *binary_data = ...;
   size_t binary_size = ...;
   
   gfx_image_dsc_t img_dsc;
   memcpy(&img_dsc.header, binary_data, sizeof(gfx_image_header_t));
   img_dsc.data = binary_data + sizeof(gfx_image_header_t);
   img_dsc.data_size = binary_size - sizeof(gfx_image_header_t);
   
   gfx_obj_t *img = gfx_img_create(handle);
   gfx_img_set_src(img, (void*)&img_dsc);
   gfx_obj_set_pos(img, 100, 100);

Image Formats
-------------

RGB565 Format
~~~~~~~~~~~~~

* 16-bit color format (5 bits red, 6 bits green, 5 bits blue)
* No alpha channel
* 2 bytes per pixel
* Memory: Width × Height × 2 bytes

RGB565A8 Format
~~~~~~~~~~~~~~~

* 16-bit RGB color with 8-bit alpha channel
* Provides transparency support
* 3 bytes per pixel (2 bytes RGB + 1 byte alpha)
* Memory: Width × Height × 3 bytes
* Data layout: RGB565 data followed by Alpha8 data

Image Conversion
----------------

Images can be converted from PNG format using the provided conversion script:

.. code-block:: bash

   # Convert to C array format
   python scripts/image_converter.py image.png

   # Convert to binary format
   python scripts/image_converter.py image.png --bin

The script supports:
* RGB565 and RGB565A8 formats
* C array and binary output formats
* Byte swapping for different endianness
* Batch conversion

